// Generated by CoffeeScript 1.3.3
(function(){var e,t,n,r;e=jQuery,t=e(window),n=function(){function t(e){this.container=e,this.items=[],this.last_scroll_top=this.container.scrollTop(),this.base_resolution={width:this.container.width(),height:this.container.height()},this.scale=1,this.bindAll(),this.setScaleFromActualResolution()}return t.prototype.bindAll=function(){var e=this;return this.container.on("scroll",function(){var t,n;return n=e.container.scrollTop(),t=e.last_scroll_top<n?"down":"up",e.processScrollAt(n,t),e.last_scroll_top=n}),this.container.on("resize",function(){return e.handleResize()})},t.prototype.listen=function(e,t){return this.items.push(new r(e,t,this.scale,this.last_scroll_top,this.sizes))},t.prototype.processScrollAt=function(t){return e.each(this.items,function(e,n){return n.scrolledAt(t)})},t.prototype.handleResize=function(){var t=this;return this.setScaleFromActualResolution(),e.each(this.items,function(e,n){return n.resizeToScale(t.scale,t.sizes)}),this.container.trigger("scroll")},t.prototype.setBaseResolution=function(e){return this.base_resolution=e,this.setScaleFromActualResolution()},t.prototype.setScaleFromActualResolution=function(){var e,t,n,r,i,s,o,u,a,f;return a=[this.container.width(),this.container.height()],n=a[0],t=a[1],e=n/t,f=[this.base_resolution.width,this.base_resolution.height],s=f[0],i=f[1],r=s/i,e>=r?(u=n,o=i*(n/s)):(u=s*(t/i),o=n),this.scale=u/s,this.sizes={width:this.base_resolution.width*this.scale,height:this.base_resolution.height*this.scale,offset:Math.max(n-u,0)/2}},t}(),r=function(){function t(t,n,r,i,s){this.scale=r,this.parent_sizes=s,this.el=e(t),this.fadeIn=n.start.fade,this.fadeOut=n.end.fade,this.easeMoveIn=n.start.easeMove,this.easeMoveOut=n.end.easeMove,this.inEasing=n.start.easing||"linear",this.outEasing=n.end.easing||"linear",this.params=n,this.last_params=null,this.sizes={width:this.el.width(),height:this.el.height()},this.resizeToScale(this.scale,this.parent_sizes),this.processPositions(),this.initPositionAt(i)}return t.prototype.processPositions=function(){var t,n,r,i=this;this.positions={},e.each(this.params,function(t,n){var r,s;if(t==="refObject"||t==="onResize"||t==="alwaysVisible")return;return r=t==="end"&&!n.x&&n.x!==0?i.params.start.x:n.x,s=t==="end"&&!n.y&&n.y!==0?i.params.start.y:n.y,i.positions[t]={bounds:typeof n.bounds=="number"?i.valueForPosition(n.bounds):e.map(n.bounds,function(e){return i.valueForPosition(e)}),x:i.valueForPosition(r)+i.parent_sizes.offset,y:i.valueForPosition(s)}});if(!this.positions.fixed)return t=this.positions.end.bounds-(this.positions.end.bounds-this.positions.start.bounds)/2,n=this.positions.end.x-(this.positions.end.x-this.positions.start.x)/2,r=this.positions.end.y-(this.positions.end.y-this.positions.start.y)/2,this.positions.fixed={bounds:[t,t],x:n,y:r}},t.prototype.initPositionAt=function(e){return this.visible=this.visibility(e),this.visible===0?this.el.fadeIn(0):this.el.fadeOut(0),this.el.css({position:"fixed"}),this.scrolledAt(e)},t.prototype.valueForPosition=function(e){var t,n,r,i,s,o,u;return typeof e=="number"?e*this.scale:(u=e.split(" "),n=u[0],i=u[1],t=i!=null&&i==="inset",r=function(){switch(n){case"left":return t?0:-this.el.outerWidth();case"right":return o=this.parent_sizes.width,t?o-this.el.outerWidth():o;case"top":return t?0:-this.el.outerHeight();case"bottom":return s=this.parent_sizes.height,t?s-this.el.outerHeight():s;case"center":return(this.parent_sizes.width-this.el.outerWidth())/2;case"middle":return(this.parent_sizes.height-this.el.outerHeight())/2}}.call(this),r)},t.prototype.scrolledAt=function(e,t){var n;t==null&&(t=!1),n=this.visibility(e);if(!n===0&&!this.visible&&!t)return;switch(n){case-1:return this.animateTo({top:this.positions.start.y,left:this.positions.start.x},!1);case 1:return this.animateTo({top:this.positions.end.y,left:this.positions.end.x},!1);case 0:return this.animateTo(this.getAnimationParamsAt(e),!0)}},t.prototype.visibility=function(e){switch(!1){case!(e<this.positions.start.bounds):return-1;case!(e>this.positions.end.bounds):return 1;default:return 0}},t.prototype.animateTo=function(e,t){if(e===this.last_params)return;this.last_params=e,this.el.stop().animate(e,0);if(t!==this.visible)return this.visible=t,t||this.params.alwaysVisible?this.el.fadeIn(0):this.el.fadeOut(0)},t.prototype.getAnimationParamsAt=function(t){var n,r,i,s,o,u,a,f,l,c,h;return this.params.refObject?a=this.processPositionsFromRefObjectAt(t):a=this.positions,i=a.fixed.bounds[0],r=a.fixed.bounds[1],l=a.start.bounds,n=a.end.bounds,t>=i&&t<=r?{top:a.fixed.y,left:a.fixed.x,opacity:1}:t<i?(f=(t-l)/(i-l),h=a.start.y,c=f*a.fixed.y-f*h+h,o=a.start.x,s=f*a.fixed.x-f*o+o,this.easeMoveIn&&(c=e.easing[this.inEasing](c,f,h,c-h,1),s=e.easing[this.inEasing](s,f,o,s-o,1)),this.fadeIn?u=e.easing[this.inEasing](f,f,1,f,1):u=1,{top:c,left:s,opacity:this.fadeIn?f:1}):(f=(t-r)/(n-r),h=a.fixed.y,o=a.fixed.x,c=f*a.end.y-f*h+h,s=f*a.end.x-f*o+o,this.easeMoveOut&&(c=e.easing[this.outEasing](c,f,h,c-h,1),s=e.easing[this.outEasing](s,f,o,s-o,1)),this.fadeOut?u=1-f*e.easing[this.outEasing](1-f,f,1,1-f,1):u=1,{top:c,left:s,opacity:u})},t.prototype.resizeToScale=function(t,n){var r,i,s;return this.scale=t,this.parent_sizes=n,s=[this.sizes.width*this.scale,this.sizes.height*this.scale],i=s[0],r=s[1],e.isFunction(this.params.onResize)&&this.params.onResize(this.el,i,r),this.el.css({width:i,height:r}),this.processPositions()},t.prototype.processPositionsFromRefObjectAt=function(t){var n,r,i=this;return n=this.params.refObject.offset(),r=e.extend(!0,{},this.positions),e.each(this.positions,function(e,i){return r[e].x=i.x+n.left,r[e].y=i.y-(t-n.top)}),r},t}(),e.fn.pullItUp=function(r,i,s){var o,u,a;return i==null&&(i=null),s==null&&(s=t),u=typeof r=="string",o=typeof s.jquery!="undefined"?e(s):s,a=o.data("pullitup"),a||(a=new n(o),o.data("pullitup",a)),u&&typeof a[r]!="undefined"?a[r](i):this.each(function(){return a.listen(this,r)})}}).call(this);